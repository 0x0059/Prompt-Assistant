# ğŸ“ é¡¹ç›®ç»“æ„æ–‡æ¡£

> æœ¬æ–‡æ¡£è¯¦ç»†è¯´æ˜é¡¹ç›®çš„æ–‡ä»¶å’Œç›®å½•ç»“æ„ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿç†è§£ä»£ç ç»„ç»‡ã€‚å…³äºå¼€å‘æµç¨‹å’Œç¯å¢ƒé…ç½®ï¼Œè¯·å‚è€ƒ [å¼€å‘æŒ‡å—](./dev.md)ã€‚

## ğŸ“Š æ•´ä½“æ¶æ„æ¦‚è§ˆ

é¡¹ç›®é‡‡ç”¨ monorepo æ¶æ„ï¼Œä½¿ç”¨ pnpm workspace ç®¡ç†å¤šä¸ªåŒ…ï¼ŒåŒ…æ‹¬æ ¸å¿ƒåŠŸèƒ½ã€UIç»„ä»¶åº“ã€Webåº”ç”¨å’Œæµè§ˆå™¨æ‰©å±•ã€‚

```
prompt-assistant/
â”œâ”€â”€ packages/           # é¡¹ç›®åŒ…ç›®å½•
â”‚   â”œâ”€â”€ core/          # æ ¸å¿ƒåŠŸèƒ½åŒ… - æä¾›åŸºç¡€æœåŠ¡å’ŒAPI
â”‚   â”œâ”€â”€ ui/            # UIç»„ä»¶åº“ - å…±äº«UIç»„ä»¶
â”‚   â”œâ”€â”€ web/           # Webåº”ç”¨ - ç½‘é¡µç‰ˆåº”ç”¨
â”‚   â””â”€â”€ extension/     # æµè§ˆå™¨æ‰©å±• - Chromeæ’ä»¶
â”œâ”€â”€ api/               # APIç›¸å…³é…ç½® - Vercel Edge Functions
â”œâ”€â”€ docs/              # é¡¹ç›®æ–‡æ¡£ - å¼€å‘æ–‡æ¡£å’Œè¯´æ˜
â”œâ”€â”€ scripts/           # å·¥å…·è„šæœ¬ - æ„å»ºå’Œè¾…åŠ©å·¥å…·
â”œâ”€â”€ docker/            # Dockeré…ç½® - å®¹å™¨åŒ–éƒ¨ç½²
â””â”€â”€ images/            # é¡¹ç›®å›¾ç‰‡èµ„æº - æˆªå›¾å’ŒLogo
```

## ğŸ“‚ ç›®å½•ç»“æ„è¯¦è§£

### 1ï¸âƒ£ æ ¹ç›®å½•é…ç½®æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
|------|------|
| `package.json` | é¡¹ç›®é…ç½®ï¼Œå®šä¹‰ä¾èµ–å’Œè„šæœ¬ |
| `pnpm-workspace.yaml` | å·¥ä½œåŒºé…ç½®ï¼Œå®šä¹‰å­åŒ…è·¯å¾„ |
| `.env.example` | ç¯å¢ƒå˜é‡ç¤ºä¾‹ï¼ŒåŒ…å«APIå¯†é’¥ç­‰é…ç½® |
| `docker-compose.yml` | Docker Composeé…ç½®ï¼Œç”¨äºå®¹å™¨åŒ–éƒ¨ç½² |
| `Dockerfile` | Dockeræ„å»ºé…ç½®ï¼Œå®šä¹‰æ„å»ºæ­¥éª¤ |
| `.dockerignore` | Dockerå¿½ç•¥é…ç½®ï¼Œæ’é™¤ä¸éœ€è¦çš„æ–‡ä»¶ |
| `vercel.json` | Verceléƒ¨ç½²é…ç½®ï¼ŒåŒ…å«è·¯ç”±å’ŒEdge Functions |
| `.npmrc` | NPMé…ç½®ï¼Œè®¾ç½®åŒ…ç®¡ç†å™¨è¡Œä¸º |
| `.pnpmrc` | PNPMé…ç½®ï¼Œè®¾ç½®ç‰¹å®šçš„pnpmè¡Œä¸º |
| `.gitignore` | Gitå¿½ç•¥é…ç½®ï¼Œæ’é™¤ä¸éœ€è¦ç‰ˆæœ¬æ§åˆ¶çš„æ–‡ä»¶ |
| `.cursorrules` | Cursor IDEé…ç½®ï¼ŒAIè¾…åŠ©å¼€å‘è§„åˆ™ |
| `.windsurfrules` | Windsurf IDEé…ç½®ï¼Œé¡¹ç›®è§„èŒƒæ£€æŸ¥ |

### 2ï¸âƒ£ æ ¸å¿ƒåŒ… (packages/core)

`packages/core` æä¾›æ ¸å¿ƒåŠŸèƒ½å’ŒæœåŠ¡ï¼Œä¸ºå…¶ä»–åŒ…æä¾›åŸºç¡€æ”¯æŒã€‚

#### æºä»£ç ç»“æ„ (packages/core/src/)

```
src/
â”œâ”€â”€ services/           # æ ¸å¿ƒæœåŠ¡ç›®å½•
â”‚   â”œâ”€â”€ llm/           # LLMæœåŠ¡
â”‚   â”‚   â”œâ”€â”€ openai.ts  # OpenAIæœåŠ¡å®ç°
â”‚   â”‚   â”œâ”€â”€ gemini.ts  # GeminiæœåŠ¡å®ç°
â”‚   â”‚   â”œâ”€â”€ deepseek.ts# DeepSeekæœåŠ¡å®ç°
â”‚   â”‚   â””â”€â”€ types.ts   # æœåŠ¡ç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â”œâ”€â”€ model/         # æ¨¡å‹ç®¡ç†
â”‚   â”‚   â”œâ”€â”€ manager.ts # æ¨¡å‹ç®¡ç†å™¨ - ç»Ÿä¸€æ¥å£
â”‚   â”‚   â”œâ”€â”€ config.ts  # æ¨¡å‹é…ç½®å®šä¹‰
â”‚   â”‚   â””â”€â”€ types.ts   # æ¨¡å‹ç±»å‹å®šä¹‰
â”‚   â”‚
â”‚   â””â”€â”€ prompt/        # æç¤ºè¯æœåŠ¡
â”‚       â”œâ”€â”€ service.ts # æç¤ºè¯æœåŠ¡å®ç°
â”‚       â”œâ”€â”€ template.ts# æç¤ºè¯æ¨¡æ¿
â”‚       â”œâ”€â”€ history.ts # å†å²è®°å½•ç®¡ç†
â”‚       â””â”€â”€ types.ts   # æç¤ºè¯ç±»å‹å®šä¹‰
â”‚
â”œâ”€â”€ utils/             # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ storage.ts     # å­˜å‚¨å·¥å…·
â”‚   â”œâ”€â”€ crypto.ts      # åŠ å¯†è§£å¯†
â”‚   â”œâ”€â”€ format.ts      # æ ¼å¼åŒ–å·¥å…·
â”‚   â””â”€â”€ error.ts       # é”™è¯¯å¤„ç†
â”‚
â””â”€â”€ types/             # å…¬å…±ç±»å‹å®šä¹‰
    â”œâ”€â”€ api.ts         # APIç›¸å…³ç±»å‹
    â”œâ”€â”€ config.ts      # é…ç½®ç±»å‹
    â””â”€â”€ index.ts       # ç±»å‹å¯¼å‡º
```

#### æ ¸å¿ƒæ¨¡å—è¯´æ˜

| æ¨¡å— | åŠŸèƒ½è¯´æ˜ |
|------|---------|
| `services/llm` | å®ç°å„å¤§æ¨¡å‹APIè°ƒç”¨çš„ç»Ÿä¸€æ¥å£ï¼ŒåŒ…æ‹¬è®¤è¯ã€è¯·æ±‚å’Œå“åº”å¤„ç† |
| `services/model` | ç®¡ç†ä¸åŒAIæ¨¡å‹çš„é…ç½®ã€å¯†é’¥å’ŒçŠ¶æ€ |
| `services/prompt` | æä¾›æç¤ºè¯å¤„ç†ã€ä¼˜åŒ–å’Œå†å²è®°å½•åŠŸèƒ½ |
| `utils` | æä¾›é€šç”¨å·¥å…·å‡½æ•°ï¼Œå¦‚å­˜å‚¨ã€åŠ å¯†ã€æ ¼å¼åŒ–ç­‰ |
| `types` | å®šä¹‰å…¨å±€ä½¿ç”¨çš„TypeScriptç±»å‹å’Œæ¥å£ |

#### æ ¸å¿ƒä¾èµ–

```json
{
  "dependencies": {
    "@google/generative-ai": "^0.21.0",  // Gemini APIå®¢æˆ·ç«¯
    "openai": "^4.83.0",                 // OpenAI APIå®¢æˆ·ç«¯
    "uuid": "^11.0.5",                   // å”¯ä¸€IDç”Ÿæˆ
    "zod": "^3.22.4"                     // æ•°æ®éªŒè¯
  }
}
```

### 3ï¸âƒ£ UIç»„ä»¶åº“ (packages/ui)

`packages/ui` åŒ…å«å…±äº«UIç»„ä»¶ï¼Œè¢«Webåº”ç”¨å’Œæµè§ˆå™¨æ‰©å±•å¤ç”¨ã€‚

#### æºä»£ç ç»“æ„ (packages/ui/src/)

```
src/
â”œâ”€â”€ components/           # Vueç»„ä»¶
â”‚   â”œâ”€â”€ common/           # é€šç”¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Button.vue    # æŒ‰é’®ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Input.vue     # è¾“å…¥æ¡†ç»„ä»¶
â”‚   â”‚   â””â”€â”€ Modal.vue     # æ¨¡æ€æ¡†ç»„ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ layout/           # å¸ƒå±€ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Header.vue    # é¡µå¤´ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Footer.vue    # é¡µè„šç»„ä»¶
â”‚   â”‚   â””â”€â”€ Container.vue # å®¹å™¨ç»„ä»¶
â”‚   â”‚
â”‚   â”œâ”€â”€ prompt/           # æç¤ºè¯ç›¸å…³ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Editor.vue    # ç¼–è¾‘å™¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Optimizer.vue # ä¼˜åŒ–å™¨ç»„ä»¶
â”‚   â”‚   â””â”€â”€ Compare.vue   # å¯¹æ¯”ç»„ä»¶
â”‚   â”‚
â”‚   â””â”€â”€ settings/         # è®¾ç½®ç›¸å…³ç»„ä»¶
â”‚       â”œâ”€â”€ ModelManager.vue  # æ¨¡å‹ç®¡ç†ç»„ä»¶
â”‚       â”œâ”€â”€ ApiKeyInput.vue   # APIå¯†é’¥è¾“å…¥ç»„ä»¶
â”‚       â””â”€â”€ ThemeToggle.vue   # ä¸»é¢˜åˆ‡æ¢ç»„ä»¶
â”‚
â”œâ”€â”€ styles/               # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ variables.css     # CSSå˜é‡
â”‚   â”œâ”€â”€ common.css        # é€šç”¨æ ·å¼
â”‚   â”œâ”€â”€ themes.css        # ä¸»é¢˜æ ·å¼
â”‚   â””â”€â”€ index.css         # æ ·å¼å…¥å£
â”‚
â”œâ”€â”€ i18n/                 # å›½é™…åŒ–èµ„æº
â”‚   â”œâ”€â”€ locales/          # è¯­è¨€æ–‡ä»¶ç›®å½•
â”‚   â”‚   â”œâ”€â”€ en-US.ts      # è‹±æ–‡ç¿»è¯‘
â”‚   â”‚   â””â”€â”€ zh-CN.ts      # ä¸­æ–‡ç¿»è¯‘
â”‚   â””â”€â”€ index.ts          # i18né…ç½®
â”‚
â”œâ”€â”€ hooks/                # Vueç»„åˆå¼å‡½æ•°
â”‚   â”œâ”€â”€ useModel.ts       # æ¨¡å‹ç›¸å…³é’©å­
â”‚   â”œâ”€â”€ usePrompt.ts      # æç¤ºè¯ç›¸å…³é’©å­
â”‚   â””â”€â”€ useTheme.ts       # ä¸»é¢˜ç›¸å…³é’©å­
â”‚
â””â”€â”€ index.ts              # ç»„ä»¶åº“å…¥å£ï¼Œå¯¼å‡ºæ‰€æœ‰ç»„ä»¶
```

#### UIä¾èµ–

```json
{
  "dependencies": {
    "@prompt-assistant/core": "workspace:*",  // æ ¸å¿ƒåŒ…
    "element-plus": "^2.5.6",                // UIç»„ä»¶åº“
    "vue": "^3.3.4"                          // Vueæ¡†æ¶
  }
}
```

### 4ï¸âƒ£ Webåº”ç”¨ (packages/web)

`packages/web` æ˜¯é¢å‘æµè§ˆå™¨çš„Webåº”ç”¨å®ç°ã€‚

#### æºä»£ç ç»“æ„ (packages/web/src/)

```
src/
â”œâ”€â”€ components/       # åº”ç”¨ç‰¹æœ‰ç»„ä»¶
â”‚   â”œâ”€â”€ Header.vue    # åº”ç”¨å¤´éƒ¨
â”‚   â”œâ”€â”€ Sidebar.vue   # ä¾§è¾¹æ 
â”‚   â””â”€â”€ Footer.vue    # åº”ç”¨åº•éƒ¨
â”‚
â”œâ”€â”€ views/            # é¡µé¢è§†å›¾
â”‚   â”œâ”€â”€ Home.vue      # é¦–é¡µ
â”‚   â”œâ”€â”€ Optimizer.vue # ä¼˜åŒ–å™¨é¡µé¢
â”‚   â””â”€â”€ Settings.vue  # è®¾ç½®é¡µé¢
â”‚
â”œâ”€â”€ store/            # çŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ index.ts      # Storeé…ç½®
â”‚   â”œâ”€â”€ modules/      # Storeæ¨¡å—
â”‚   â””â”€â”€ persist.ts    # æŒä¹…åŒ–é…ç½®
â”‚
â”œâ”€â”€ router/           # è·¯ç”±é…ç½®
â”‚   â”œâ”€â”€ index.ts      # è·¯ç”±å®šä¹‰
â”‚   â””â”€â”€ guards.ts     # è·¯ç”±å®ˆå«
â”‚
â”œâ”€â”€ assets/           # é™æ€èµ„æº
â”‚   â”œâ”€â”€ images/       # å›¾ç‰‡èµ„æº
â”‚   â””â”€â”€ styles/       # æ ·å¼èµ„æº
â”‚
â”œâ”€â”€ plugins/          # æ’ä»¶é…ç½®
â”‚   â”œâ”€â”€ i18n.ts       # å›½é™…åŒ–é…ç½®
â”‚   â””â”€â”€ themes.ts     # ä¸»é¢˜é…ç½®
â”‚
â”œâ”€â”€ App.vue           # åº”ç”¨æ ¹ç»„ä»¶
â””â”€â”€ main.ts           # åº”ç”¨å…¥å£
```

#### Webä¾èµ–

```json
{
  "dependencies": {
    "@prompt-assistant/ui": "workspace:*",   // UIç»„ä»¶åº“
    "vue": "^3.5.13",                       // Vueæ¡†æ¶
    "vue-router": "^4.2.5"                  // è·¯ç”±
  }
}
```

### 5ï¸âƒ£ æµè§ˆå™¨æ‰©å±• (packages/extension)

`packages/extension` æ˜¯Chromeæµè§ˆå™¨æ‰©å±•å®ç°ã€‚

#### æºä»£ç ç»“æ„ (packages/extension/src/)

```
src/
â”œâ”€â”€ popup/            # å¼¹å‡ºçª—å£
â”‚   â”œâ”€â”€ App.vue       # å¼¹å‡ºçª—å£åº”ç”¨
â”‚   â”œâ”€â”€ main.ts       # å¼¹å‡ºçª—å£å…¥å£
â”‚   â””â”€â”€ index.html    # å¼¹å‡ºçª—å£HTML
â”‚
â”œâ”€â”€ background/       # åå°è„šæœ¬
â”‚   â””â”€â”€ index.ts      # åå°æœåŠ¡å…¥å£
â”‚
â”œâ”€â”€ content/          # å†…å®¹è„šæœ¬
â”‚   â””â”€â”€ index.ts      # å†…å®¹è„šæœ¬å…¥å£
â”‚
â”œâ”€â”€ options/          # é€‰é¡¹é¡µé¢
â”‚   â”œâ”€â”€ App.vue       # é€‰é¡¹é¡µé¢åº”ç”¨
â”‚   â””â”€â”€ main.ts       # é€‰é¡¹é¡µé¢å…¥å£
â”‚
â”œâ”€â”€ utils/            # æ‰©å±•ç‰¹æœ‰å·¥å…·
â”‚   â”œâ”€â”€ messaging.ts  # æ¶ˆæ¯é€šä¿¡
â”‚   â””â”€â”€ storage.ts    # æ‰©å±•å­˜å‚¨
â”‚
â”œâ”€â”€ assets/           # æ‰©å±•èµ„æº
â”‚   â””â”€â”€ icons/        # æ‰©å±•å›¾æ ‡
â”‚
â””â”€â”€ manifest.json     # æ‰©å±•æ¸…å•æ–‡ä»¶
```

#### æ‰©å±•ä¾èµ–

```json
{
  "dependencies": {
    "@prompt-assistant/ui": "workspace:*",   // UIç»„ä»¶åº“
    "webextension-polyfill": "^0.10.0"      // æµè§ˆå™¨æ‰©å±•APIå…¼å®¹å±‚
  }
}
```

## ğŸ”„ ä¾èµ–å…³ç³»å›¾

```mermaid
graph TD
    web[packages/web] --> ui[packages/ui]
    extension[packages/extension] --> ui
    ui --> core[packages/core]
    
    subgraph "æ ¸å¿ƒåŠŸèƒ½"
        core
    end
    
    subgraph "ç”¨æˆ·ç•Œé¢"
        ui
    end
    
    subgraph "åº”ç”¨å®ç°"
        web
        extension
    end
```

ç®€åŒ–çš„ä¾èµ–å…³ç³»ï¼š

```
@prompt-assistant/web
â””â”€â”€ @prompt-assistant/ui
    â””â”€â”€ @prompt-assistant/core

@prompt-assistant/extension
â””â”€â”€ @prompt-assistant/ui
    â””â”€â”€ @prompt-assistant/core
```

## ğŸ› ï¸ å¼€å‘å·¥å…·é›†æˆ

### Cursor IDEé…ç½®

`.cursorrules` æ–‡ä»¶å®šä¹‰äº†AIè¾…åŠ©å¼€å‘è§„åˆ™ï¼ŒåŒ…æ‹¬ï¼š

- ä»£ç å®¡æŸ¥è§„åˆ™
- è‡ªåŠ¨ç”Ÿæˆæ³¨é‡Šè§„åˆ™
- ä»£ç è¡¥å…¨è¡Œä¸ºé…ç½®
- AIæç¤ºæ¨¡æ¿

### Windsurf IDEé…ç½®

`.windsurfrules` æ–‡ä»¶å®šä¹‰äº†é¡¹ç›®è§„èŒƒï¼ŒåŒ…æ‹¬ï¼š

- ä»£ç é£æ ¼æ£€æŸ¥è§„åˆ™
- æ–‡ä»¶å‘½åè§„èŒƒ
- å¯¼å…¥æ’åºè§„åˆ™
- æ–‡æ¡£æ ¼å¼è¦æ±‚

### Git Hooks

`.husky/` ç›®å½•åŒ…å«Gité’©å­é…ç½®ï¼Œç”¨äºï¼š

- æäº¤å‰ä»£ç æ£€æŸ¥
- æäº¤ä¿¡æ¯æ ¼å¼éªŒè¯
- æ¨é€å‰æµ‹è¯•è¿è¡Œ

---

æœ€åæ›´æ–°ï¼š2024-07-09
